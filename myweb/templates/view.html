<!DOCTYPE html>
<html>
<head>
    <title>{{ post.title }}</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>{{ post.title }}</h1>
    <p>작성자: {{ post.author.username }} | 작성일: {{ post.date_posted.strftime('%Y-%m-%d %H:%M:%S') }}</p>
    <div class="content">
        {{ post.content|replace('\n', '<br>')|safe }}
    </div>
    <p><a href="{{ url_for('board') }}">게시판으로 돌아가기</a></p>
    {% if current_user.is_authenticated and current_user == post.author %}
        <p>
            <a href="{{ url_for('edit_post', post_id=post.id) }}">수정</a> |
            <a href="{{ url_for('delete_post', post_id=post.id) }}" onclick="return confirm('정말로 삭제하시겠습니까?')">삭제</a>
        </p>
    {% endif %}

    <h2>댓글</h2>
    {% if post.comments %}
        <ul>
            {% for comment in post.comments %}
                <li>
                    <strong>{{ comment.author.username }}</strong> ({{ comment.date_posted.strftime('%Y-%m-%d %H:%M:%S') }}):
                    {{ comment.content|replace('\n', '<br>')|safe }}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>아직 댓글이 없습니다.</p>
    {% endif %}

    {% if current_user.is_authenticated %}
        <h3>댓글 작성</h3>
        <form method="POST" action="{{ url_for('add_comment', post_id=post.id) }}">
            <textarea name="content" rows="5" cols="80" required></textarea><br><br>
            <input type="submit" value="댓글 작성">
        </form>
    {% else %}
        <p><a href="{{ url_for('login') }}">로그인</a> 후 댓글을 작성할 수 있습니다.</p>
    {% endif %}
</body>
</html>